

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>2. 评价模型 &#8212; 数学建模系列课程</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. 预测模型" href="prediction_model.html" />
    <link rel="prev" title="1. 规划模型" href="LP.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/qe-logo-large.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">数学建模系列课程</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="LP.html">
   1. 规划模型
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2. 评价模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prediction_model.html">
   3. 预测模型
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="answers.html">
   4. 作业解答
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/docs/evaluation_model.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/evaluation_model.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/quantecon-mini-example"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/quantecon-mini-example/master?urlpath=tree/mini_book/docs/evaluation_model.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   2.1. 评价模型介绍
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   2.2. 数据预处理方法
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     2.2.1. 评价指标的筛选方法
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       2.2.1.1. 最小均方差法
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       2.2.1.2. 极大极小离差法
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     2.2.2. 指标的一致化处理
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       2.2.2.1. 极小型指标化为极大型指标
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       2.2.2.2. 居中型指标化为极大型指标
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       2.2.2.3. 区间型指标化为极大型指标
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     2.2.3. 指标的无量纲化处理
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id12">
       2.2.3.1. 标准样本变换法
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       2.2.3.2. 比例变换法
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       2.2.3.3. 向量归一化法
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id15">
       2.2.3.4. 极差变换法
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id16">
       2.2.3.5. 功效系数法
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     2.2.4. 定性指标的定量化
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#topsis">
   2.3. TOPSIS方法
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id18">
   2.4. 熵权法
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id19">
   2.5. 层次分析法
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id20">
     2.5.1. 层次单排序和总排序
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id21">
     2.5.2. 判断一致性
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id22">
     2.5.3. 案例：企业的资金使用
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id23">
   2.6. 评价模型总结
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1><span class="section-number">2. </span>评价模型<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2><span class="section-number">2.1. </span>评价模型介绍<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>我们常常会遇到如下的综合评价问题：<strong>在若干个(同类)对象中，从多个维度对其进行评分，将这些评分综合后，给定一个最终排名</strong>。如好大学排名，运动员排名，城市排名等。</p>
<div class="figure align-default" id="directive-fig">
<a class="reference internal image-reference" href="https://cdn.kesci.com/upload/image/qg32efllvm.jpg?imageView2/0"><img alt="https://cdn.kesci.com/upload/image/qg32efllvm.jpg?imageView2/0" src="https://cdn.kesci.com/upload/image/qg32efllvm.jpg?imageView2/0" style="height: 300px;" /></a>
</div>
<p>这时候我们就需要用到评价模型，评价模型是数学建模比赛中最基础也是最常用的模型, 例如<a class="reference external" href="https://www.comap.com/highschool/contests/himcm/2018problems.html">2018年HiMCM A题</a> 就专门考察了评价模型。</p>
<p>如何去思考综合评价问题的建模呢？通常有如下五个角度</p>
<ul class="simple">
<li><p><strong>评价对象</strong>：评价对象就是综合评价问题中所研究的对象，或称为系统。通常情况下，在一个问题中评价对象是属于同一类的，且个数要大于1，不妨假设一个综合评价问题中有<span class="math notranslate nohighlight">\(n\)</span>个评价对象，分别记为</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
S_{1}, S_{2}, \cdots, S_{n}(n&gt;1)
\]</div>
<ul class="simple">
<li><p><strong>评价指标</strong>：评价指标是反映评价对象的运行（或发展）状况的基本要素。通常的问题都是有多项指标构成，每一项指标都是从不同的侧面刻画系统所具有某种特征大小的一个度量。一个综合评价问题的评价指标一般可用一个向量<span class="math notranslate nohighlight">\(x\)</span>表示，称为评价指标问题，其中每一个分量就是从一个侧面反映系统的状态，即称为综合评价的指标体系。不失一般性，设系统有<span class="math notranslate nohighlight">\(m\)</span>个评价指标，分别记为</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
x_{1}, x_{2}, \cdots, x_{m}(m&gt;1)
\]</div>
<ul class="simple">
<li><p><strong>权重系数</strong>： 每一个综合评价问题都有相应的评价目的，针对某种评价目的，各评价指标之间的相对重要性是不同的，评价指标之间的这种相对重要性的大小，可用权重系数来刻画。当各评价对象和评价指标值都确定以后，综合评价结果就依赖于权重系数的取值了，即<strong>权重系数确定的合理与否，直接关系到综合评价结果的可信度，甚至影响到最后决策的正确性</strong>。因此，权重系数的确定要特别谨慎，应按一定的方法和原则来确定。如果用<span class="math notranslate nohighlight">\(w_{j}(j=1,2, \cdots, m)\)</span>来表示评价指标<span class="math notranslate nohighlight">\(x_j\)</span>的权重系数，一般应满足</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
w_{j} \geq 0, j=1,2, \cdots, m  \quad  并且  \quad  \sum_{j=1}^{m} w_{j}=1
\]</div>
<ul class="simple">
<li><p><strong>综合模型</strong> 对于多指标（或多因素）的综合评价问题，就是要通过建立一定的数学模型将多个评价指标值综合成为一个整体的综合评价值，作为综合评价的依据，从而得到相应的评价结果。</p></li>
<li><p><strong>评价者</strong> 评价者是直接参与评价的人，可以是一个人，也可以是一个团体。对于评价目的选择、评价指标体系确定、权重系数的确定和评价模型的建立都与评价者有关。因此，评价者在评价过程中的作用是不可小视的。</p></li>
</ul>
<p>目前国内外综合评价方法有数十种之多，其中主要使用的评价方法有</p>
<ul class="simple">
<li><p>主成分分析法</p></li>
<li><p>因子分析</p></li>
<li><p><strong>TOPSIS</strong></p></li>
<li><p>秩和比法</p></li>
<li><p>灰色关联法</p></li>
<li><p><strong>熵权法</strong></p></li>
<li><p><strong>层次分析法</strong></p></li>
<li><p>模糊评价法</p></li>
<li><p>物元分析法</p></li>
<li><p>聚类分析法</p></li>
<li><p>价值工程法</p></li>
<li><p>神经网络法等</p></li>
</ul>
<p>方法多样，各自有其适用场景。本次课程，我们重点展开讲其中较为常用的<strong>TOPSIS、熵权法和层次分析法</strong>。</p>
<p>在展开这三个模型之前，我们首先来看一下数据的预处理方法。</p>
</div>
<div class="section" id="id3">
<h2><span class="section-number">2.2. </span>数据预处理方法<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>一般情况下，在综合评价指标中，有的指标比较重要，有的影响微乎其微，另外各指标值可能属于不同类型、不同单位或不同数量级，从而使得各指标之间存在着不可公度性，给综合评价带来了诸多不便。为了尽可能地反映实际情况，消除由于各项指标间的这些差别带来的影响，避免出现不合理的评价结果，就需要对评价指标进行一定的预处理，包括</p>
<ol class="simple">
<li><p><strong>指标的筛选</strong></p></li>
<li><p><strong>指标的一致化处理</strong></p></li>
<li><p><strong>无量纲化处理</strong></p></li>
<li><p><strong>定性数据定量化</strong></p></li>
</ol>
<p>下面分别介绍。</p>
<div class="section" id="id4">
<h3><span class="section-number">2.2.1. </span>评价指标的筛选方法<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>要根据综合评价的目的，针对具体的评价对象、评价内容收集有关指标信息，采用适当的筛选方法对指标进行筛选，合理地选取主要指标，剔除次要指标，以简化评价指标体系。常用的评价指标筛选方法主要有专家调研法、<strong>最小均方差法、极大极小离差法</strong>等。我们重点来看后两种方法。</p>
<div class="section" id="id5">
<h4><span class="section-number">2.2.1.1. </span>最小均方差法<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>对于<span class="math notranslate nohighlight">\(n\)</span>个评价对象<span class="math notranslate nohighlight">\(S_{1}, S_{2}, \cdots, S_{n}\)</span>，每个评价对象有<span class="math notranslate nohighlight">\(m\)</span>个指标，其观测值分别为</p>
<div class="math notranslate nohighlight">
\[
a_{i j}(i=1,2, \cdots, n ; j=1,2, \cdots, m)
\]</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>最小均方差法的出发点是： 如果<span class="math notranslate nohighlight">\(n\)</span>个评价对象关于某项指标的观测值都差不多，那么不管这个评价指标重要与否，对于这<span class="math notranslate nohighlight">\(n\)</span>个评价对象的评价结果所起的作用将是很小的。因此，在评价过程中就可以删除这样的评价指标。</p>
</div>
<p>最小均方差法的筛选过程如下：</p>
<ul class="simple">
<li><p>首先求出第<span class="math notranslate nohighlight">\(j\)</span>项指标的平均值和均方差</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\mu_{j}=\frac{1}{n} \sum_{i=1}^{n} a_{i j}
\]</div>
<div class="math notranslate nohighlight">
\[
s_{j}=\sqrt{\frac{1}{n} \sum_{i=1}^{n}\left(a_{i j}-\mu_{j}\right)^{2}}, \quad j=1,2, \cdots, m
\]</div>
<ul class="simple">
<li><p>求出最小均方差</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
{S}_{j_{0}}=\min _{1 \leq j \leq m}\left\{{s}_{j}\right\}
\]</div>
<ul class="simple">
<li><p>如果最小均方差<span class="math notranslate nohighlight">\(S_{j_{0}} \approx 0\)</span>，则可删除与<span class="math notranslate nohighlight">\(S_{j_{0}}\)</span>对应的指标 。考察完所有指标，即可得到最终的评价指标体系。</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>注意：最小均方差法只考虑了指标的差异程度，也有可能将重要的指标删除。你能否举一个例子?</p>
</div>
</div>
<div class="section" id="id6">
<h4><span class="section-number">2.2.1.2. </span>极大极小离差法<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>对于<span class="math notranslate nohighlight">\(n\)</span>个评价对象<span class="math notranslate nohighlight">\(S_{1}, S_{2}, \cdots, S_{n}\)</span>，每个评价对象有<span class="math notranslate nohighlight">\(m\)</span>个指标，其观测值分别为</p>
<div class="math notranslate nohighlight">
\[
a_{i j}(i=1,2, \cdots, n ; j=1,2, \cdots, m)
\]</div>
<p>极大极小离差法的筛选过程如下：</p>
<ul class="simple">
<li><p>求出第<span class="math notranslate nohighlight">\(j\)</span>项指标的最大离差</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
d_{j}=\max _{1 \leq i,k \leq n}\left\{\left|a_{i j}-a_{k j}\right|\right\}, j=1,2, \cdots, m
\]</div>
<ul class="simple">
<li><p>求出最小离差</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
d_{j_{0}}=\min _{1 \leq j \leq n}\left\{d_{j}\right\}
\]</div>
<ul class="simple">
<li><p>如果最小离差<span class="math notranslate nohighlight">\(d_{j_{0}} \approx 0\)</span>，则可删除与<span class="math notranslate nohighlight">\(d_{j_{0}}\)</span>对应的指标<span class="math notranslate nohighlight">\(x_{j_{0}}\)</span>，考察完所有指标，即可得到最终的评价指标体系。</p></li>
</ul>
<p>其他几个常用的评价指标筛选方法还有条件广义方差极小法、极大不相关法等，这里限于篇幅不再展开。</p>
</div>
</div>
<div class="section" id="id7">
<h3><span class="section-number">2.2.2. </span>指标的一致化处理<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>所谓一致化处理就是将评价指标的类型进行统一。</p>
<p>一般来说，在评价指标体系中，可能会同时存在极大型指标、极小型指标、居中型指标和区间型指标，它们都具有不同的特点。</p>
<p>若指标体系中存在不同类型的指标，必须在综合评价之前将评价指标的类型做一致化处理。</p>
<p>例如，将各类指标都转化为极大型指标，或极小型指标。一般的做法是将非极大型指标转化为极大型指标。</p>
<div class="section" id="id8">
<h4><span class="section-number">2.2.2.1. </span>极小型指标化为极大型指标<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>对极小型指标<span class="math notranslate nohighlight">\(x_j\)</span>，将其转化为极大型指标时，只需对指标<span class="math notranslate nohighlight">\(x_j\)</span>取倒数：</p>
<div class="math notranslate nohighlight">
\[
x_{j}^{\prime}=\frac{1}{x_{j}}
\]</div>
<p>或做平移变换：</p>
<div class="math notranslate nohighlight">
\[
x_{j}^{\prime}=M_{j}-x_{j}
\]</div>
<p>其中,<span class="math notranslate nohighlight">\(M_{j}=\max _{1 \leq i \leq n}\left\{a_{i j}\right\}\)</span>,即<span class="math notranslate nohighlight">\(n\)</span>个评价对象第<span class="math notranslate nohighlight">\(j\)</span>项指标值<span class="math notranslate nohighlight">\(a_{ij}\)</span>最大者。</p>
<p>当然，其他能改变单调性的转换方法也是可行的。</p>
</div>
<div class="section" id="id9">
<h4><span class="section-number">2.2.2.2. </span>居中型指标化为极大型指标<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>对居中型指标<span class="math notranslate nohighlight">\(x_j\)</span>,令<span class="math notranslate nohighlight">\(M_{j}=\max _{1 \leq i \leq n}\left\{a_{i j}\right\}, \quad m_{j}=\min _{1 \leq i \leq n}\left\{a_{i j}\right\}\)</span>,取</p>
<div class="math notranslate nohighlight">
\[\begin{split}
x_{j}^{\prime}=\left\{\begin{array}{ll}
{\frac{2\left(x_{j}-m_{j}\right)}{M_{j}-m_{j}},} &amp; {m_{j} \leq x_{j} \leq \frac{M_{j}+m_{j}}{2}} \\
{\frac{2\left(M_{j}-x_{j}\right)}{M_{j}-m_{j}},} &amp; {\frac{M_{j}+m_{j}}{2} \leq x_{j} \leq M_{j}}
\end{array}\right.
\end{split}\]</div>
<p>就可以将<span class="math notranslate nohighlight">\(x_j\)</span>转化为极大型指标。</p>
</div>
<div class="section" id="id10">
<h4><span class="section-number">2.2.2.3. </span>区间型指标化为极大型指标<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>对区间型指标<span class="math notranslate nohighlight">\(x_j\)</span>， <span class="math notranslate nohighlight">\(x_j\)</span>是取值介于区间<span class="math notranslate nohighlight">\(\left[b_{j}^{(1)}, b_{j}^{(2)}\right]\)</span>,内时为最好，指标值离该区间越远就越差。令</p>
<div class="math notranslate nohighlight">
\[
M_{j}=\max _{1 \leq i \leq n}\left\{a_{i j}\right\}, \quad m_{j}=\min _{\| \leq i \leq n}\left\{a_{i j}\right\}, \quad c_{j}=\max \left\{b_{j}^{(1)}-m_{j}, M_{j}-b_{j}^{(2)}\right\}
\]</div>
<p>就可以将区间型指标<span class="math notranslate nohighlight">\(x_j\)</span>转化为极大型指标。</p>
<div class="math notranslate nohighlight">
\[\begin{split}
x_{j}'=\left\{\begin{array}{lll}
{1-\dfrac{b_{j}^{(1)}-x_{j}}{c_{j}},} &amp; {x_{j} &lt; b_{j}^{(1)}} \\
{1,} &amp; {b_{j}^{(1)} \leq x_{j} \leq b_{j}^{(2)}} \\
{1-\dfrac{x_{j}-b_{j}^{(2)}}{c_{j}},} &amp; {x_{j} &gt; b_{j}^{(2)}}
\end{array}\right.
\end{split}\]</div>
</div>
</div>
<div class="section" id="id11">
<h3><span class="section-number">2.2.3. </span>指标的无量纲化处理<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p><strong>所谓无量纲化，也称为指标的规范化，是通过数学变换来消除原始指标的单位及其数值数量级影响的过程。</strong></p>
<p>因此，就有指标的实际值和评价值之分。一般地，将指标无量纲化处理以后的值称为指标评价值。</p>
<p>无量纲化过程就是将指标实际值转化为指标评价值的过程。</p>
<p>对于<span class="math notranslate nohighlight">\(n\)</span>个评价对象<span class="math notranslate nohighlight">\(S_{1}, S_{2}, \cdots, S_{n}\)</span>，每个评价对象有<span class="math notranslate nohighlight">\(m\)</span>个指标，其观测值分别为</p>
<div class="math notranslate nohighlight">
\[
a_{i j}(i=1,2, \cdots, n ; j=1,2, \cdots, m)
\]</div>
<div class="section" id="id12">
<h4><span class="section-number">2.2.3.1. </span>标准样本变换法<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>令</p>
<div class="math notranslate nohighlight">
\[
a_{i j}^{*}=\frac{a_{i j}-\mu_{j}}{s_{j}}(1 \leq i \leq n, 1 \leq j \leq m)
\]</div>
<p>其中样本均值<span class="math notranslate nohighlight">\(\mu_{j}=\frac{1}{n} \sum_{i=1}^{n} a_{i j}\)</span>,样本均方差<span class="math notranslate nohighlight">\(s_{j}=\sqrt{\frac{1}{n} \sum_{i=1}^{n}\left(a_{i j}-\mu_{j}\right)^{2}}\)</span>,称为标准观测值。</p>
</div>
<div class="section" id="id13">
<h4><span class="section-number">2.2.3.2. </span>比例变换法<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>对于极大型指标，令</p>
<div class="math notranslate nohighlight">
\[
a_{i j}^{*}=\frac{a_{i j}}{\max _{1 \leq i \leq n} a_{i j}}\left(\max _{1 \leq i \leq n} a_{i j} \neq 0,1 \leq i \leq n, 1 \leq j \leq m\right)
\]</div>
<p>对极小型指标，令</p>
<div class="math notranslate nohighlight">
\[
a_{i j}^{*}=\frac{\min a_{i j}}{a_{i j}}(1 \leq i \leq n, 1 \leq j \leq m)
\]</div>
<p>或</p>
<div class="math notranslate nohighlight">
\[
a_{i j}^{*}=1-\frac{a_{i j}}{\max _{1 \leq i \leq n} a_{i j}}\left(\max _{1 \leq i \leq n} a_{i j} \neq 0,1 \leq i \leq n, 1 \leq j \leq m\right)
\]</div>
<p>该方法的优点是这些变换前后的属性值成比例。但对任一指标来说，变换后的<span class="math notranslate nohighlight">\(a_{i j}^{*} = 1\)</span>和<span class="math notranslate nohighlight">\(a_{i j}^{*}= 0\)</span>不一定同时出现。</p>
</div>
<div class="section" id="id14">
<h4><span class="section-number">2.2.3.3. </span>向量归一化法<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<p>对于极大型指标，令</p>
<div class="math notranslate nohighlight">
\[
a_{i j}^{*}=\frac{a_{i j}}{\sqrt{\sum_{i=1}^{n} a_{i j}^{2}}}(i=1,2, \cdots, n, 1 \leq j \leq m)
\]</div>
<p>对于极小型指标，令</p>
<div class="math notranslate nohighlight">
\[
a_{i j}^{*}=1-\frac{a_{i j}}{\sqrt{\sum_{i=1}^{n} a_{i j}^{2}}}(i=1,2, \cdots, n, 1 \leq j \leq m)
\]</div>
</div>
<div class="section" id="id15">
<h4><span class="section-number">2.2.3.4. </span>极差变换法<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>对于极大型指标</p>
<div class="math notranslate nohighlight">
\[
a_{i j}^{*}=\frac{a_{i j}-\min _{1 \leq i \leq n} a_{i j}}{\max _{1 \leq i \leq n} a_{i j}-\min _{1 \leq i \leq n} a_{i j}}(1 \leq i \leq n, 1 \leq j \leq m)
\]</div>
<p>对于极小型直指标</p>
<div class="math notranslate nohighlight">
\[
a_{i j}^{*}=\frac{\max _{1 \leq i \leq n} a_{i j}-a_{i j}}{\max _{1 \leq i \leq n} a_{i j}-\min _{1 \leq i \leq n} a_{i j}}(1 \leq i \leq n, 1 \leq j \leq m)
\]</div>
<p>其特点为经过极差变换后，均有<span class="math notranslate nohighlight">\(0 \leq a_{i j}^{*} \leq 1\)</span>，且最优指标值<span class="math notranslate nohighlight">\(a_{i j}^{*}=1\)</span>，最劣指标值<span class="math notranslate nohighlight">\(a_{i j}^{*}=0\)</span>。该方法的缺点是变换前后的各指标值不成比例。</p>
</div>
<div class="section" id="id16">
<h4><span class="section-number">2.2.3.5. </span>功效系数法<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h4>
<p>令，</p>
<div class="math notranslate nohighlight">
\[
a_{i j}^{*}=c+\frac{a_{i j}-\min _{1 \leq i \leq n} a_{i j}}{\max _{1 \leq i \leq n} a_{i j}-\min _{1 \leq i \leq n} a_{i j}} \times d(1 \leq i \leq n, 1 \leq j \leq m)
\]</div>
<p>其<span class="math notranslate nohighlight">\(c,d\)</span>均为确定的常数，<span class="math notranslate nohighlight">\(c\)</span>表示“平移量”，表示指标实际基础值， <span class="math notranslate nohighlight">\(d\)</span>表示“旋转量”，即表示“放大”或“缩小”倍数</p>
</div>
</div>
<div class="section" id="id17">
<h3><span class="section-number">2.2.4. </span>定性指标的定量化<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>在综合评价工作中，有些评价指标是定性指标，即只给出定性的描述，例如，质量很好、性能一般、可靠性高等。对于这些指标，在进行综合评价时，必须先通过适当的方式进行赋值，使其量化。一般来说，对于指标最优值可赋值1，对于指标最劣值可赋值0。对极大型定性指标常按以下方式赋值。</p>
<p>对于极大型定性指标而言，如果指标能够分为很低、低、一般、高和很高五个等级，则可以分别取量化值为0，0.1，0.3，0.5，0.7，1，对应关系如下表所示。介于两个等级之间的可以取两个分值之间的适当数值作为量化值。极小型指标同理。</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>等级</p></th>
<th class="head"><p>很低</p></th>
<th class="head"><p>低</p></th>
<th class="head"><p>一般</p></th>
<th class="head"><p>高</p></th>
<th class="head"><p>很高</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>量化值</p></td>
<td><p>0</p></td>
<td><p>0.3</p></td>
<td><p>0.5</p></td>
<td><p>0.7</p></td>
<td><p>0.9</p></td>
</tr>
</tbody>
</table>
<p>下面我们通过几个例子来学习三种常用的评价模型。分别是TOPSIS方法，熵权法和层次分析法。</p>
</div>
</div>
<div class="section" id="topsis">
<h2><span class="section-number">2.3. </span>TOPSIS方法<a class="headerlink" href="#topsis" title="Permalink to this headline">¶</a></h2>
<p>C.L.Hwang 和 K.Yoon 于1981年首次提出 TOPSIS (全称：Technique for Order Preference by Similarity to an Ideal Solution)。</p>
<p>TOPSIS 法是一种常用的组内综合评价方法，能充分利用原始数据的信息，其结果能精确地反映各评价方案之间的差距。</p>
<p>基本过程为基于归一化后的原始数据矩阵，采用余弦法找出有限方案中的<strong>最优方案和最劣方案</strong>，然后分别计算各评价对象与最优方案和最劣方案间的距离，获得各评价对象与最优方案的相对接近程度，以此作为评价优劣的依据。</p>
<p>该方法对数据分布及样本含量没有严格限制，数据计算简单易行。</p>
<p>为了客观地评价我国研究生教育的实际状况和各研究生院的教学质量，国务院学位委员会办公室组织过一次研究生院的评估。为了取得经验，先选5所研究生院，收集有关数据资料进行了试评估，下表是所给出的部分数据：</p>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q36cu5oq77.png?imageView2/0/w/500/h/500" /></p>
<p>TOPSIS 法使用距离尺度来度量样本差距，使用距离尺度就需要对指标属性进行同向化处理（若一个维度的数据越大越好，另一个维度的数据越小越好，会造成尺度混乱）。通常采用成本型指标向效益型指标转化（即数值越大评价越高，事实上几乎所有的评价方法都需要进行转化）</p>
<p>通过分析，我们知道：</p>
<ul class="simple">
<li><p>人均专著，越多越好（极大型指标）</p></li>
<li><p>科研经费，越多越好（极大型指标）</p></li>
<li><p>逾期毕业率，越小越好（极小型指标）</p></li>
<li><p>生师比，过大过小都不好（区间型指标）</p></li>
</ul>
<p>设研究生院的生师比最佳区间为<span class="math notranslate nohighlight">\([5,6]\)</span>，在最佳区间内生师比得分为1 ，如果生师比小于2或者大于12都是0分，在其他的区间都按照线性关系进行变换。</p>
<p>因此，我们把两个极大型指标保持不变，对极小型指标采用取倒数操作，对区间型指标使用上面介绍的处理方法。处理结果见下图。</p>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q36dpsx5kl.png?imageView2/0/w/400/h/400" /></p>
<p>接下来，我们进行无量纲处理，以 “人均专著” 属性为例，我们使用向量归一化方法：</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
&amp;0.1 / \sqrt{0.1^{2}+0.2^{2}+0.4^{2}+0.9^{2}+1.2^{2}}=0.0637576713063384\\
&amp;0.2 / \sqrt{0.1^{2}+0.2^{2}+0.4^{2}+0.9^{2}+1.2^{2}}=0.12751534261266767\\
&amp;0.4 / \sqrt{0.1^{2}+0.2^{2}+0.4^{2}+0.9^{2}+1.2^{2}}=0.2550306852253334\\
&amp;\begin{array}{l}
{0.9 / \sqrt{0.1^{2}+0.2^{2}+0.4^{2}+0.9^{2}+1.2^{2}}=0.5738190417570045} \\
{1.2 / \sqrt{0.1^{2}+0.2^{2}+0.4^{2}+0.9^{2}+1.2^{2}}=0.7650920556760059}
\end{array}
\end{aligned}
\end{split}\]</div>
<p>使用同样的向量归一化方法，我们可以对其他三个指标也进行无量纲化处理，得到如下表所示的结果</p>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37a7zebvn.png?imageView2/0/w/400/h/400" /></p>
<p>接着，我们选出其中的最优方案和最劣方案。</p>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37a9tyx43.png?imageView2/0/w/400/h/400" /></p>
<p>然后，我们开始计算每一个学校，与最优方案以及最劣方案之间的距离</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l}
{D_{i}^{+}=\sqrt{\sum_{j=1}^{m} w_{j}\left(Z_{j}^{+}-z_{i j}\right)^{2}}} \\
{D_{i}^{-}=\sqrt{\sum_{j=1}^{m} w_{j}\left(Z_{j}^{-}-z_{i j}\right)^{2}}}
\end{array}
\end{split}\]</div>
<p>然后使用如下的评价函数将其综合起来</p>
<div class="math notranslate nohighlight">
\[
C_{i}=\frac{D_{i}^{-}}{D_{i}^{+}+D_{i}^{-}}
\]</div>
<div class="admonition- admonition">
<p class="admonition-title">思考</p>
<p>如果理想中最好的大学是真实存在的，其得分<span class="math notranslate nohighlight">\(C_i\)</span>应该等于几，为什么？如果是理想中最差的大学真实存在呢？</p>
</div>
<p>最终评价结果如下</p>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37aduhn3h.png?imageView2/0/w/640/h/640" /></p>
<p>上面是通过举例来进行TOPSIS方法的实现，关于TOPSIS方法的更详细理论推导，参考<a class="reference external" href="https://wiki.mbalib.com/wiki/TOPSIS%E6%B3%95">这里</a>。</p>
<p>在实际论文撰写的过程中，最好理论性强一些，而不是像我们上面一样简单地代入数据计算。</p>
<div class="admonition- admonition">
<p class="admonition-title">思考</p>
<p>上面的TOPSIS方法的权重已经给出，请思考，如果实际建模的时候没有给出权重，应该如何选取？</p>
</div>
</div>
<div class="section" id="id18">
<h2><span class="section-number">2.4. </span>熵权法<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h2>
<p>下面我们来学习一种客观赋权的方法：熵权法，它是一种突出局部差异的客观赋权方法。因为它的权重选取仅依赖于数据本身的离散性。</p>
<p>我们通过一个例子来看。</p>
<p>某医院为了提高自身的护理水平，对拥有的11个科室进行了考核，考核标准包括9项整体护理，并对护理水平较好的科室进行奖励。下表是对各个科室指标考核后的评分结果。</p>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37bu55zpt.png?imageView2/0/w/640/h/640" /></p>
<p>但是由于各项护理的难易程度不同，因此需要对9项护理进行赋权，以便能够更加合理的对各个科室的护理水平进行评价。根据原始评分表，对数据进行标准化后可以得到下列数据标准化表</p>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37bvhlzaq.png?imageView2/0/w/640/h/640" /></p>
<div class="admonition- admonition">
<p class="admonition-title">思考</p>
<p>这里我们用了什么归一化的方法？</p>
</div>
<p>计算第<span class="math notranslate nohighlight">\(j\)</span>项指标下第<span class="math notranslate nohighlight">\(i\)</span>个样本值所占比重</p>
<div class="math notranslate nohighlight">
\[
p_{i j}=\frac{x_{i j}}{\displaystyle \sum_{i=1}^{n} x_{i j}}, \quad i=1, \cdots, n, j=1, \cdots, m
\]</div>
<p>计算第<span class="math notranslate nohighlight">\(j\)</span>个指标的熵值(熵值的计算方法是信息论中的定义，这里我们直接采用)</p>
<div class="math notranslate nohighlight">
\[
e_{j}=-k \sum_{i=1}^{n} p_{i j} \ln \left(p_{i j}\right), \quad j=1, \cdots, m
\]</div>
<p>其中，</p>
<div class="math notranslate nohighlight">
\[
k=1 / \ln (n)&gt;0
\]</div>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37c01lxpn.png?imageView2/0/w/640/h/640" /></p>
<p>可以发现，熵值越小的变量，离散程度越大。接下来，我们计算信息熵冗余度，并将其归一化得到权重</p>
<div class="math notranslate nohighlight">
\[
d_{j}=1-e_{j}, \quad j=1, \cdots, m
\]</div>
<div class="math notranslate nohighlight">
\[
w_{j}=\frac{d_{j}}{\displaystyle\sum_{j=1}^{m} d_{j}}, \quad j=1, \cdots, m
\]</div>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37c2m8er3.png?imageView2/0/w/640/h/640" /></p>
<p>加权求和计算指标综合评分</p>
<div class="math notranslate nohighlight">
\[
s_{i}=\sum_{j=1}^{m} w_{j} x_{i j}, \quad i=1, \cdots, n
\]</div>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37c42bx6w.png?imageView2/0/w/640/h/640" /></p>
<p>上面是一个特殊的案例，接下来我们来总结熵权法的一般步骤。</p>
<p><strong>熵权法步骤</strong></p>
<ul class="simple">
<li><p>对<span class="math notranslate nohighlight">\(n\)</span>个样本，<span class="math notranslate nohighlight">\(m\)</span>个指标的数据集</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\{x_{ij}|i = 1,2,\cdots,n, \quad j = 1,2,\cdots,m\}
\]</div>
<ul class="simple">
<li><p>对指标进行归一化处理：异质指标同质化</p></li>
<li><p>计算第<span class="math notranslate nohighlight">\(j\)</span>项指标下第<span class="math notranslate nohighlight">\(i\)</span>个样本值所占比重</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
p_{i j}=\frac{x_{i j}}{\displaystyle\sum_{i=1}^{n} x_{i j}}, \quad i=1, \cdots, n, j=1, \cdots, m
\]</div>
<ul class="simple">
<li><p>计算第<span class="math notranslate nohighlight">\(j\)</span>个指标的熵值</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
e_{j}=-k \sum_{i=1}^{n} p_{i j} \ln \left(p_{i j}\right), \quad j=1, \cdots, m
\]</div>
<p>其中，</p>
<div class="math notranslate nohighlight">
\[
k=1 / \ln (n)&gt;0
\]</div>
<ul class="simple">
<li><p>计算信息熵冗余度，并将其归一化得到权重</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
d_{j}=1-e_{j}, \quad j=1, \cdots, m
\]</div>
<div class="math notranslate nohighlight">
\[
w_{j}=\frac{d_{j}}{\displaystyle\sum_{j=1}^{m} d_{j}}, \quad j=1, \cdots, m
\]</div>
<ul class="simple">
<li><p>计算指标综合评分</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
s_{i}=\sum_{j=1}^{m} w_{j} x_{i j}, \quad i=1, \cdots, n
\]</div>
<p>这里的<span class="math notranslate nohighlight">\(x_{ij}\)</span>是标准化以后的数据。</p>
<div class="admonition- admonition">
<p class="admonition-title">思考</p>
<p>熵权法是客观赋权，这里的<strong>客观</strong>就一定是优于主观的吗？经过熵权法计算得到的权重，应用中会不会有什么问题？</p>
</div>
</div>
<div class="section" id="id19">
<h2><span class="section-number">2.5. </span>层次分析法<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h2>
<p>AHP (Analytic Hierarchy Process)层次分析法是美国运筹学家Saaty教授于二十世纪80年代提出的一种实用的多方案或多目标的决策方法。其主要特征是，它合理地将定性与定量的决策结合起来，按照思维、心理的规律把决策过程层次化、数量化。 该方法自1982年被介绍到我国以来，以其定性与定量相结合地处理各种决策因素的特点，以及其系统灵活简洁的优点，迅速地在我国社会经济各个领域内，如能源系统分析、城市规划、经济管理、科研评价等，得到了广泛的重视和应用。</p>
<p>层次分析法的基本思路：先分解后综合首先将所要分析的问题层次化，根据问题的性质和要达到的总目标，将问题分解成不同的组成因素，按照因素间的相互关系及隶属关系，将因素按不同层次聚集组合，形成一个多层分析结构模型，最终归结为最低层（方案、措施、指标等）相对于最高层（总目标）相对重要程度的权值或相对优劣次序的问题。 运用层次分析法建模，大体上可按下面四个步骤进行：</p>
<ul class="simple">
<li><p>建立递阶层次结构模型；</p></li>
<li><p>构造出各层次中的所有判断矩阵；</p></li>
<li><p>层次单排序及一致性检验；</p></li>
<li><p>层次总排序及一致性检验。</p></li>
</ul>
<p>我们一样通过一个案例来学习层次分析法。</p>
<p>人们在日常生活中经常会碰到多目标决策问题，例如假期某人想要出去旅游，现有三个目的地（方案）：风光绮丽的杭州（P1）、迷人的北戴河（P2）和山水甲天下的桂林（P3）。假如选择的标准和依据（行动方案准则）有5个：景色，费用，饮食，居住和旅途。则常规思维的方式如下：</p>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37ay9fgbp.png?imageView2/0/w/500/h/500" /></p>
<p>通过相互比较确定各准则对于目标的权重，即构造判断矩阵。在层次分析法中，为使矩阵中的各要素的重要性能够进行定量显示，引进了矩阵判断标度（1～9标度法） :</p>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37azh9ui8.png?imageView2/0/w/700/h/700" /></p>
<p>构造判断矩阵</p>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37b0ivv9d.png?imageView2/0/w/960/h/960" /></p>
<div class="section" id="id20">
<h3><span class="section-number">2.5.1. </span>层次单排序和总排序<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<p>所谓层次单排序是指，对于上层某因素而言，本层次因素重要性的排序。
具体计算方法为：对于判断矩阵<span class="math notranslate nohighlight">\(B\)</span>，计算满足</p>
<div class="math notranslate nohighlight">
\[
BW=\lambda_{max} W
\]</div>
<p>的特征根与特征向量。</p>
<p>式中，<span class="math notranslate nohighlight">\(\lambda_{max}\)</span> 为矩阵<span class="math notranslate nohighlight">\(B\)</span>的最大特征跟根，<span class="math notranslate nohighlight">\(W\)</span>为对应于<span class="math notranslate nohighlight">\(\lambda_{max}\)</span>的特征向量，<span class="math notranslate nohighlight">\(W\)</span>的分量<span class="math notranslate nohighlight">\(w_i\)</span>即为相应元素单排序的权值。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1, 2, 9], [0.5, 1, 0.5], [0.1111111111111111, 2, 1]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 调用 np.linalg.eig方法计算矩阵的特征值和特征向量，其中lamb是特征值，v是特征向量</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">lamb</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>      
<span class="nb">print</span><span class="p">(</span><span class="n">lamb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 3.56083368+0.j         -0.28041684+1.38506384j -0.28041684-1.38506384j]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">lamb</span><span class="p">))</span>                    <span class="c1"># 提取最大的特征值</span>
<span class="n">loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">lamb</span> <span class="o">==</span> <span class="n">lambda_max</span><span class="p">)</span>             <span class="c1"># 获取最大特征值的索引</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">),</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>            <span class="c1"># 获取最大特征值对应的特征向量</span>
<span class="n">weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.94864674, 0.22803089, 0.21925164])
</pre></div>
</div>
</div>
</div>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37b2ynn0.png?imageView2/0/w/960/h/960" /></p>
<div class="math notranslate nohighlight">
\[\begin{split}
W=W^{(3)} W^{(2)}=\left(\begin{array}{ccccc}
{0.595} &amp; {0.082} &amp; {0.429} &amp; {0.633} &amp; {0.166} \\
{0.277} &amp; {0.236} &amp; {0.429} &amp; {0.193} &amp; {0.166} \\
{0.129} &amp; {0.682} &amp; {0.142} &amp; {0.175} &amp; {0.668}
\end{array}\right)\left(\begin{array}{c}
{0.263} \\
{0.475} \\
{0.055} \\
{0.099} \\
{0.110}
\end{array}\right)=\left(\begin{array}{c}
{0.300} \\
{0.246} \\
{0.456}
\end{array}\right)
\end{split}\]</div>
<p>决策结果是首选旅游地为<span class="math notranslate nohighlight">\(P_3\)</span> ,其次为<span class="math notranslate nohighlight">\(P_1\)</span>，再次<span class="math notranslate nohighlight">\(P_2\)</span></p>
<p>一般地，若层次结构由<span class="math notranslate nohighlight">\(k\)</span>个层次（目标层算第一层），则方案的优先程度的排序向量为:</p>
<div class="math notranslate nohighlight">
\[
W=W^{(k)} W^{(k-1)} \dots W^{(2)}
\]</div>
</div>
<div class="section" id="id21">
<h3><span class="section-number">2.5.2. </span>判断一致性<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<p>判断矩阵通常是不一致的，但是为了能用它的对应于特征根的特征向量作为被比较因素的权向量，其不一致程度应在容许的范围内.如何确定这个范围？</p>
<p>一致性指标：</p>
<div class="math notranslate nohighlight">
\[
C I=\frac{\lambda-n}{n-1}
\]</div>
<div class="math notranslate nohighlight">
\[
C R=\frac{C I}{R I}
\]</div>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37bi9mx9r.png?imageView2/0/w/960/h/960" /></p>
<p>当<span class="math notranslate nohighlight">\(CR&lt;0.1\)</span>时，认为层次排序是具有满意的一致性的，我们可以接受该分析结果。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="c1"># 调用 np.linalg.eig方法计算矩阵的特征值和特征向量，其中lamb是特征值，v是特征向量</span>
<span class="n">lamb</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>      
<span class="n">lambda_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">lamb</span><span class="p">))</span>                    <span class="c1"># 提取最大的特征值</span>
<span class="n">loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">lamb</span> <span class="o">==</span> <span class="n">lambda_max</span><span class="p">)</span>             <span class="c1"># 获取最大特征值的索引</span>
<span class="n">weight</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">),</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>            <span class="c1"># 获取最大特征值对应的特征向量</span>
<span class="n">RI_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mf">0.58</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">1.12</span><span class="p">,</span><span class="mf">1.24</span><span class="p">,</span><span class="mf">1.32</span><span class="p">,</span><span class="mf">1.41</span><span class="p">,</span><span class="mf">1.45</span><span class="p">]</span>   
<span class="n">RI</span> <span class="o">=</span> <span class="n">RI_list</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                        <span class="c1"># 计算RI</span>
<span class="n">CI</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_max</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>         <span class="c1"># 计算CI</span>
<span class="n">CR</span> <span class="o">=</span> <span class="n">CI</span> <span class="o">/</span> <span class="n">RI</span>                                   <span class="c1"># 计算CR</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;最大特征值 lambda_max=&#39;</span><span class="p">,</span><span class="n">lambda_max</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;最大特征值对应的特征向量 w=&#39;</span><span class="p">,</span><span class="n">weight</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CI=&#39;</span><span class="p">,</span><span class="n">CI</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RI=&#39;</span><span class="p">,</span><span class="n">RI</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CR=&#39;</span><span class="p">,</span><span class="n">CR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>最大特征值 lambda_max= 3.075599563855794
最大特征值对应的特征向量 w= [0.90191687 0.3919986  0.18133684]
CI= 0.037799781927897014
RI= 0.58
CR= 0.065172037806719
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id22">
<h3><span class="section-number">2.5.3. </span>案例：企业的资金使用<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37bozvxls.png?imageView2/0/w/960/h/960" /></p>
<p>构造判断矩阵</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A=\left(\begin{array}{ccc}{1} &amp; {1 / 5} &amp; {1 / 3} \\ {5} &amp; {1} &amp; {3} \\ {3} &amp; {1 / 3} &amp; {1}\end{array}\right)
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
B_{1}=\left(\begin{array}{ccccc}{1} &amp; {2} &amp; {3} &amp; {4} &amp; {7} \\ {1 / 3} &amp; {1} &amp; {3} &amp; {2} &amp; {5} \\ {1 / 5} &amp; {1 / 3} &amp; {1} &amp; {1 / 2} &amp; {1} \\ {1 / 4} &amp; {1 / 2} &amp; {2} &amp; {1} &amp; {3} \\ {1 / 7} &amp; {1 / 5} &amp; {1 / 2} &amp; {1 / 3} &amp; {1}\end{array}\right) \quad B_{2}=\left(\begin{array}{cccc}{1} &amp; {1 / 7} &amp; {1 / 3} &amp; {1 / 5} \\ {7} &amp; {1} &amp; {5} &amp; {3} \\ {3} &amp; {1 / 5} &amp; {1} &amp; {1 / 3} \\ {5} &amp; {1 / 2} &amp; {3} &amp; {1}\end{array}\right) \quad B_{3}=\left(\begin{array}{cccc}{1} &amp; {1} &amp; {3} &amp; {3} \\ {1} &amp; {1} &amp; {3} &amp; {3} \\ {1 / 3} &amp; {1 / 3} &amp; {1} &amp; {1} \\ {1 / 7} &amp; {1 / 3} &amp; {1} &amp; {1}\end{array}\right)
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 层次分析法函数</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">AHP</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="n">lamb</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>                      <span class="c1"># 调用 np.linalg.eig方法计算矩阵的特征值和特征向量，其中lamb是特征值，v是特征向量</span>
    <span class="n">lambda_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">lamb</span><span class="p">))</span>                    <span class="c1"># 提取最大的特征值</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">lamb</span> <span class="o">==</span> <span class="n">lambda_max</span><span class="p">)</span>             <span class="c1"># 获取最大特征值的索引</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">),</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>            <span class="c1"># 获取最大特征值对应的特征向量</span>
    <span class="n">RI_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="p">,</span><span class="mi">0</span> <span class="p">,</span><span class="mf">0.58</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">1.12</span><span class="p">,</span><span class="mf">1.24</span><span class="p">,</span><span class="mf">1.32</span><span class="p">,</span><span class="mf">1.41</span><span class="p">,</span><span class="mf">1.45</span><span class="p">]</span>   
    <span class="n">RI</span> <span class="o">=</span> <span class="n">RI_list</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                        <span class="c1"># 计算RI</span>
    <span class="n">CI</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_max</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>         <span class="c1"># 计算CI</span>
    <span class="n">CR</span> <span class="o">=</span> <span class="n">CI</span> <span class="o">/</span> <span class="n">RI</span>                                   <span class="c1"># 计算CR</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;最大特征值 lambda_max=&#39;</span><span class="p">,</span><span class="n">lambda_max</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;最大特征值对应的特征向量 w=&#39;</span><span class="p">,</span><span class="n">weight</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CI=&#39;</span><span class="p">,</span><span class="n">CI</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RI=&#39;</span><span class="p">,</span><span class="n">RI</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CR=&#39;</span><span class="p">,</span><span class="n">CR</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">weight</span><span class="p">,</span><span class="n">CI</span><span class="p">,</span><span class="n">RI</span><span class="p">,</span><span class="n">CR</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>    <span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="c1"># A = np.array([[1, 1/5, 1/3],</span>
<span class="c1">#              [5,  1,    3],</span>
<span class="c1">#              [3, 1/3,   1]])            # 输入判断矩阵</span>
<span class="n">weight</span><span class="p">,</span><span class="n">CI</span><span class="p">,</span><span class="n">RI</span><span class="p">,</span><span class="n">CR</span> <span class="o">=</span> <span class="n">AHP</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>最大特征值 lambda_max= 5.072084408570216
最大特征值对应的特征向量 w= [0.46582183 0.84086331 0.09509743 0.17329948 0.19204866]
CI= 0.018021102142554035
RI= 1.12
CR= 0.01609026977013753
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>     <span class="c1"># 输入判断矩阵</span>
<span class="n">weight</span><span class="p">,</span><span class="n">CI</span><span class="p">,</span><span class="n">RI</span><span class="p">,</span><span class="n">CR</span> <span class="o">=</span> <span class="n">AHP</span><span class="p">(</span><span class="n">B1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>最大特征值 lambda_max= 4.788701831199925
最大特征值对应的特征向量 w= [0.82658145 0.46109858 0.14590859 0.27045896 0.09855884]
CI= -0.05282454220001864
RI= 1.12
CR= -0.04716476982144521
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">7</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span> <span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>             <span class="c1"># 输入判断矩阵</span>
<span class="n">weight</span><span class="p">,</span><span class="n">CI</span><span class="p">,</span><span class="n">RI</span><span class="p">,</span><span class="n">CR</span> <span class="o">=</span> <span class="n">AHP</span><span class="p">(</span><span class="n">B2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>最大特征值 lambda_max= 4.204930164418752
最大特征值对应的特征向量 w= [0.08512486 0.8766546  0.17994402 0.43800756]
CI= 0.06831005480625052
RI= 0.9
CR= 0.07590006089583391
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>     <span class="c1"># 输入判断矩阵</span>
<span class="n">weight</span><span class="p">,</span><span class="n">CI</span><span class="p">,</span><span class="n">RI</span><span class="p">,</span><span class="n">CR</span> <span class="o">=</span> <span class="n">AHP</span><span class="p">(</span><span class="n">B3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>最大特征值 lambda_max= 3.9999999999999996
最大特征值对应的特征向量 w= [0.67082039 0.67082039 0.2236068  0.2236068 ]
CI= -1.4802973661668753e-16
RI= 0.9
CR= -1.644774851296528e-16
</pre></div>
</div>
</div>
</div>
<p><img alt="Image Name" src="https://cdn.kesci.com/upload/image/q37bsjooi.png?imageView2/0/w/960/h/960" /></p>
</div>
</div>
<div class="section" id="id23">
<h2><span class="section-number">2.6. </span>评价模型总结<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h2>
<p>评价问题的流程：</p>
<ol class="simple">
<li><p>筛选指标</p></li>
<li><p>指标一致化和无量纲化</p></li>
<li><p>确定权重</p></li>
<li><p>使用合适的综合评价方法，加权综合求评分,得到结果</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul class="simple">
<li><p>优先选择客观方法，但也具有其局限性</p></li>
<li><p>如果选用了主观方法（AHP）,一定不要忘记一致性检验和敏感性分析</p></li>
</ul>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="LP.html" title="previous page"><span class="section-number">1. </span>规划模型</a>
    <a class='right-next' id="next-link" href="prediction_model.html" title="next page"><span class="section-number">3. </span>预测模型</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By LinCol Education<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>